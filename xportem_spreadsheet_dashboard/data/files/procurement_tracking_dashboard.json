{
    "version": 21,
    "sheets": [
      {
        "id": "sheet1",
        "name": "Tracking",
        "colNumber": 8,
        "rowNumber": 70,
        "rows": {
          "5": { "size": 40 },
          "25": { "size": 40 },
          "45": { "size": 40 }
        },
        "cols": {
          "0": { "size": 400 },
          "1": { "size": 150 },
          "2": { "size": 150 },
          "3": { "size": 50 },
          "4": { "size": 400 },
          "5": { "size": 150 },
          "6": { "size": 150 }
        },
        "merges": [],
        "cells": {
          "A6": {
            "content": "[Estado de Muestras y Envíos](odoo://view/{\"viewType\":\"graph\",\"action\":{\"domain\":[],\"context\":{\"group_by\":[\"state\"],\"graph_measure\":\"__count\",\"graph_mode\":\"pie\",\"graph_groupbys\":[\"state\"]},\"modelName\":\"project.task.sample\",\"views\":[[false,\"graph\"],[false,\"pivot\"],[false,\"search\"]]},\"threshold\":0,\"name\":\"Estado de Tracking\"})"
          },
          
          "E6": {
            "content": "[Muestras/Envíos Vencidos](odoo://view/{\"viewType\":\"list\",\"action\":{\"domain\":[[\"is_overdue\",\"=\",true],[\"state\",\"not in\",[\"received\",\"cancelled\"]]],\"context\":{},\"modelName\":\"project.task.sample\",\"views\":[[false,\"list\"],[false,\"kanban\"],[false,\"form\"]]},\"threshold\":0,\"name\":\"Alertas de Vencimiento\"})"
          },
          
          "A26": {
            "content": "[Ubicación Actual de Muestras](odoo://view/{\"viewType\":\"pivot\",\"action\":{\"domain\":[[\"state\",\"=\",\"in_transit\"]],\"context\":{\"group_by\":[\"current_location_id\"],\"pivot_measures\":[\"__count\"],\"pivot_column_groupby\":[],\"pivot_row_groupby\":[\"current_location_id\"]},\"modelName\":\"project.task.sample\",\"views\":[[false,\"pivot\"],[false,\"graph\"]]},\"threshold\":0,\"name\":\"Tracking por Ubicación\"})"
          },
          "A27": { "content": "=_t(\"Ubicación\")" },
          "A28": { "content": "=PIVOT.HEADER(1,\"#current_location_id\",1)" },
          "A29": { "content": "=PIVOT.HEADER(1,\"#current_location_id\",2)" },
          "A30": { "content": "=PIVOT.HEADER(1,\"#current_location_id\",3)" },
          "A31": { "content": "=PIVOT.HEADER(1,\"#current_location_id\",4)" },
          
          "B27": { "content": "=_t(\"Muestras\")" },
          "B28": { "content": "=PIVOT.VALUE(1,\"__count\",\"#current_location_id\",1)" },
          "B29": { "content": "=PIVOT.VALUE(1,\"__count\",\"#current_location_id\",2)" },
          "B30": { "content": "=PIVOT.VALUE(1,\"__count\",\"#current_location_id\",3)" },
          "B31": { "content": "=PIVOT.VALUE(1,\"__count\",\"#current_location_id\",4)" },
          
          "C27": { "content": "=_t(\"Días Promedio\")" },
          "C28": { "content": "=PIVOT.VALUE(1,\"days_in_transit\",\"#current_location_id\",1)" },
          "C29": { "content": "=PIVOT.VALUE(1,\"days_in_transit\",\"#current_location_id\",2)" },
          "C30": { "content": "=PIVOT.VALUE(1,\"days_in_transit\",\"#current_location_id\",3)" },
          "C31": { "content": "=PIVOT.VALUE(1,\"days_in_transit\",\"#current_location_id\",4)" },
          
          "E26": {
            "content": "[Costos de Muestras Pendientes](odoo://view/{\"viewType\":\"list\",\"action\":{\"domain\":[[\"payment_state\",\"=\",\"pending\"]],\"context\":{},\"modelName\":\"project.task.sample\",\"views\":[[false,\"list\"],[false,\"form\"]]},\"threshold\":0,\"name\":\"Pagos Pendientes\"})"
          },
          
          "A46": {
            "content": "[Timeline de Tracking](odoo://view/{\"viewType\":\"gantt\",\"action\":{\"domain\":[[\"state\",\"not in\",[\"received\",\"cancelled\"]]],\"context\":{},\"modelName\":\"project.task.sample\",\"views\":[[false,\"gantt\"],[false,\"list\"]]},\"threshold\":0,\"name\":\"Timeline de Envíos\"})"
          }
        },
        "styles": {
          "A6": 1,
          "E6": 1,
          "A26": 1,
          "E26": 1,
          "A46": 1,
          "A27:C27": 2,
          "A28:C31": 3
        },
        "borders": {
          "A6:C6": 1,
          "E6:G6": 1,
          "A26:C26": 1,
          "E26:G26": 1,
          "A46:G46": 1,
          "A27:C27": 2
        },
        "conditionalFormats": [
          {
            "rule": {
              "type": "CellIsRule",
              "operator": "GreaterThan",
              "value": "30",
              "style": { "fillColor": "#FFCCCC" }
            },
            "id": "days-alert",
            "ranges": ["C28:C31"]
          }
        ],
        "figures": [
          {
            "id": "status-pie-chart",
            "x": 0,
            "y": 155,
            "width": 500,
            "height": 350,
            "tag": "chart",
            "data": {
              "title": { "text": "Distribución por Estado" },
              "background": "#FFFFFF",
              "legendPosition": "right",
              "type": "odoo_pie",
              "metaData": {
                "groupBy": ["state"],
                "measure": "__count",
                "resModel": "project.task.sample",
                "mode": "pie"
              },
              "searchParams": {
                "domain": [],
                "groupBy": ["state"]
              }
            }
          },
          {
            "id": "kpi-total-transito",
            "x": 550,
            "y": 12,
            "width": 265,
            "height": 101,
            "tag": "chart",
            "data": {
              "title": {
                "text": "Total en Tránsito",
                "bold": true,
                "color": "#434343"
              },
              "type": "scorecard",
              "background": "#E1F5FE",
              "keyValue": "Data!A2",
              "humanize": false
            }
          },
          {
            "id": "kpi-vencidas",
            "x": 825,
            "y": 12,
            "width": 265,
            "height": 101,
            "tag": "chart",
            "data": {
              "title": {
                "text": "Muestras Vencidas",
                "bold": true,
                "color": "#FFFFFF"
              },
              "type": "scorecard",
              "background": "#F44336",
              "keyValue": "Data!A3",
              "humanize": false
            }
          }
        ]
      },
      {
        "id": "data-sheet",
        "name": "Data",
        "colNumber": 5,
        "rowNumber": 10,
        "cells": {
          "A1": { "content": "=_t(\"Indicador\")" },
          "A2": { "content": "=ODOO.PIVOT.VALUE(2,\"__count\",\"state\",\"in_transit\")" },
          "A3": { "content": "=ODOO.PIVOT.VALUE(3,\"__count\",\"is_overdue\",true)" }
        },
        "isVisible": false
      }
    ],
    "pivots": {
      "1": {
        "type": "ODOO",
        "fieldMatching": {},
        "context": {},
        "domain": [["state", "=", "in_transit"]],
        "id": "1",
        "measures": [
          { "id": "__count", "fieldName": "__count" },
          { "id": "days_in_transit", "fieldName": "days_in_transit" }
        ],
        "model": "project.task.sample",
        "name": "Tracking por Ubicación",
        "formulaId": "1",
        "columns": [],
        "rows": [{ "fieldName": "current_location_id" }]
      },
      "2": {
        "type": "ODOO",
        "fieldMatching": {},
        "context": {},
        "domain": [],
        "id": "2",
        "measures": [{ "id": "__count", "fieldName": "__count" }],
        "model": "project.task.sample",
        "name": "Muestras por Estado",
        "formulaId": "2",
        "columns": [{ "fieldName": "state" }],
        "rows": []
      },
      "3": {
        "type": "ODOO",
        "fieldMatching": {},
        "context": {},
        "domain": [["state", "not in", ["received", "cancelled"]]],
        "id": "3",
        "measures": [{ "id": "__count", "fieldName": "__count" }],
        "model": "project.task.sample",
        "name": "Muestras Vencidas",
        "formulaId": "3",
        "columns": [{ "fieldName": "is_overdue" }],
        "rows": []
      }
    },
    "globalFilters": [
      {
        "id": "tracking-type-filter",
        "type": "relation",
        "label": "Tipo",
        "modelName": "project.task.sample",
        "fieldName": "tracking_type",
        "defaultValue": [],
        "defaultValueDisplayNames": []
      },
      {
        "id": "supplier-filter",
        "type": "relation",
        "label": "Proveedor",
        "modelName": "res.partner",
        "defaultValue": [],
        "defaultValueDisplayNames": []
      }
    ]
  }